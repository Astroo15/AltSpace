<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Astro ‚Äì AltSpace</title>

<style>
body {
  background:black url("https://i.imgur.com/0Z8FQYF.gif");
  color:white;
  font-family:Arial;
}

.box {
  border:2px dashed hotpink;
  background:black;
  padding:20px;
  max-width:800px;
  margin:30px auto;
}

h1 { color:cyan; }
button {
  background:hotpink;
  border:none;
  padding:8px;
  font-weight:bold;
}
input, textarea {
  width:95%;
  background:black;
  color:white;
  border:1px solid cyan;
}
</style>
</head>

<body>

<div class="box">
  <h1 id="username">Astro üï∏Ô∏è</h1>
  <p id="email">loading...</p>

  <p><b>Bio:</b> <span id="bio">internet kid energy</span></p>

  <button onclick="showEditor()">Customize</button>

  <div id="editor" style="display:none;">
    <textarea id="bioInput"></textarea><br><br>
    <input type="color" id="colorInput"><br><br>
    <button onclick="saveProfile()">Save</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDNLeNACWjr0dr41g_utjpVBdGUpTwCJdg",
  authDomain: "altspace-25aed.firebaseapp.com",
  projectId: "altspace-25aed"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.showEditor = () =>
  editor.style.display = "block";

window.saveProfile = async () => {
  const user = auth.currentUser;
  await setDoc(doc(db, "profiles", user.uid), {
    bio: bioInput.value,
    color: colorInput.value
  });

  bio.innerText = bioInput.value;
  username.style.color = colorInput.value;
};

onAuthStateChanged(auth, async user => {
  if (!user) return location.href="index.html";
  email.innerText = user.email;

  const snap = await getDoc(doc(db, "profiles", user.uid));
  if (snap.exists()) {
    bio.innerText = snap.data().bio;
    username.style.color = snap.data().color;
  }
});
</script>
</body>
</html>
